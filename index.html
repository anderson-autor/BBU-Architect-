<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8">
    <title>BBU Architect Simulator (Training Edition)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="startTipOverlay" class="welcome-tip-box">
        <span class="material-icons" style="color:#f1c40f; font-size:24px;">lightbulb</span>
        <span>DICA: Ative o <strong>MODO CURSO</strong> para melhor afinidade.</span>
    </div>

    <div id="deployAnimationOverlay">
        <div class="anim-status" id="animStatusText">INITIALIZING...</div>
        
        <div class="deploy-stage" id="stageAssembly">
            <div class="rack-frame">
                <div class="rack-rails"></div>
                <div class="bbu-chassis-anim" id="animBBU">BBU 5900<br><span style="font-size:10px; font-weight:normal">Huawei Technologies</span></div>
            </div>
        </div>

        <div class="deploy-stage" id="stageTower">
            <div class="tower-scene" id="towerScene">
                <div class="city-bg"></div>
                <div class="ground-line"></div>
                <svg class="tower-svg" viewBox="0 0 200 450" preserveAspectRatio="xMidYMax">
                    <path class="tw-lattice" d="M80,450 L120,450 L85,380 L115,380 L88,310 L112,310 L90,240 L110,240 L92,170 L108,170 L95,100 L105,100 M80,450 L115,380 L88,310 L110,240 L92,170 L105,100 M120,450 L85,380 L112,310 L90,240 L108,170 L95,100" />
                    <path class="tw-structure" d="M80,450 L95,100 L95,50 M120,450 L105,100 L105,50" />
                    <line class="tw-platform" x1="70" y1="100" x2="130" y2="100" />
                    <rect x="70" y="95" width="60" height="5" class="tw-platform" />
                    <line class="tw-pole" x1="100" y1="100" x2="100" y2="20" />
                    <path class="tw-structure" d="M100,60 L75,60 M100,60 L125,60 M100,80 L80,80 M100,80 L120,80" />
                    <rect class="tw-antenna" x="70" y="45" width="6" height="35" rx="1" />
                    <rect class="tw-rru" x="78" y="55" width="5" height="10" />
                    <rect class="tw-antenna" x="124" y="45" width="6" height="35" rx="1" />
                    <rect class="tw-rru" x="117" y="55" width="5" height="10" />
                    <rect class="tw-antenna" x="97" y="50" width="6" height="35" rx="1" style="fill:#eee"/>
                    <circle class="tw-beacon" cx="100" cy="20" r="4" />
                </svg>
                <div class="cabinet-outdoor"><div class="cabinet-led"></div></div>
                <div class="signal-wave"></div>
                <div class="signal-wave"></div>
                <div class="signal-wave"></div>
            </div>
        </div>

        <div class="anim-controls">
            <button class="btn-cancel" onclick="closeDeployAnim()">FECHAR SIMULAÇÃO</button>
        </div>
    </div>

    <div id="tutorialOverlay" class="tutorial-overlay">
        <div class="tutorial-card">
            <div class="tuto-header">
                <span class="material-icons" style="color:#3498db;">school</span>
                <span class="tuto-title" id="tutoTitle">Bem-vindo ao BBU Architect.</span>
            </div>
            <div class="tuto-body" id="tutoText">
                Este é o seu ambiente de simulação. Vamos fazer um tour rápido pelas ferramentas?
            </div>
            <div class="tuto-footer">
                <button class="tuto-btn btn-skip" onclick="fecharTutorial()">Pular Tutorial</button>
                <div style="display:flex; gap:10px; align-items:center;">
                    <span class="tuto-steps" id="tutoStepCount">1 / 8</span>
                    <button class="tuto-btn btn-next" onclick="proximoPassoTutorial()">Próximo ➝</button>
                </div>
            </div>
        </div>
    </div>

    <div id="setupModalOverlay">
        <div class="setup-box-modern">
            <div class="setup-header">
                <div class="setup-icon-pulse">
                    <span class="material-icons">router</span>
                </div>
                <h2>BBU ARCHITECT <span class="version-tag">SIMULATOR</span></h2>
                <p>Environment Configuration</p>
            </div>

            <div class="input-group-modern">
                <span class="input-icon material-icons">location_on</span>
                <div class="input-wrapper">
                    <label for="inSiteBBU">Site ID (Local)</label>
                    <input type="text" id="inSiteBBU" placeholder="Ex: SPO001" autocomplete="off">
                </div>
            </div>

            <div class="input-group-modern">
                <span class="input-icon material-icons">hub</span>
                <div class="input-wrapper">
                    <label for="inSiteCentral">Remote Hub (Opcional)</label>
                    <input type="text" id="inSiteCentral" placeholder="Deixe vazio para Single Site" autocomplete="off">
                </div>
            </div>

            <div class="input-group-modern">
                <span class="input-icon material-icons">bolt</span>
                <div class="input-wrapper">
                    <label for="inTensao">Voltage Input</label>
                    <input type="text" id="inTensao" value="-48V" readonly style="color: #2ecc71; font-weight:bold; cursor: default;">
                </div>
            </div>

            <button class="btn-start-modern" onclick="iniciarSimulacao()">
                <span>INITIALIZE SYSTEM</span>
                <span class="material-icons">arrow_forward</span>
            </button>
            
            <div class="setup-footer">
                <span class="status-indicator"></span> System Ready
            </div>
        </div>
    </div>

    <div id="newSiteModalOverlay" class="custom-modal-overlay">
        <div class="custom-modal-box">
            <h3 style="color:#2ecc71; margin-bottom:10px; text-transform:uppercase;">Novo Site</h3>
            <p style="color:#aaa; font-size:12px; margin-bottom:15px;">Digite o nome da nova caixa de site:</p>
            <input type="text" id="inNewSiteName" class="input-remote-site" placeholder="Ex: Torre Norte" autocomplete="off" style="width:80%; margin-bottom:15px; text-align:center;">
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeAddSiteModal()">Cancelar</button>
                <button class="btn-confirm" onclick="confirmAddSite()">CRIAR</button>
            </div>
        </div>
    </div>

    <div class="sim-container" id="simContainer">
        
        <div class="sidebar-header" id="mainHeader">
            <div class="branding-container">
                <i class="material-icons main-app-logo">account_tree</i>
                <div class="header-title">
                    <div style="font-weight: 600; font-size: 18px; letter-spacing: 1px; color:#f37021;">BBU Architect Simulator</div>
                    <div style="font-size: 10px; opacity: 0.7; letter-spacing: 2px; color:#777;">TRAINING EDITION V2.1</div>
                </div>
            </div>
            
            <div class="header-actions" id="toolbarActions">
                <div class="power-stats-container">
                    <div class="p-label">
                        <span>⚡ POWER BUDGET</span>
                        <span id="pTextVal" class="p-val">0W / 0W</span>
                    </div>
                    <div class="p-bar-bg">
                        <div id="pBarFill" class="p-bar-fill"></div>
                    </div>
                </div>
                
                <div style="display:flex; gap:10px; margin-right:15px; padding-left:15px; border-left:1px solid #444; height: 30px; align-items: center;">
                    
                    <input type="file" id="fileInputImport" style="display:none" accept=".json" onchange="processarArquivoImportado(this)">

                    <button class="header-btn" onclick="document.getElementById('fileInputImport').click()" 
                            style="background:#2c3e50; width: auto; padding: 0 12px; justify-content: center; gap: 6px;" 
                            title="Carregar Cenário Salvo">
                        <span class="material-icons" style="font-size:16px; color:#3498db;">folder_open</span>
                        <span style="font-size: 11px;">Upload Config</span>
                    </button>

                    <button class="header-btn" onclick="exportarCenarioJSON()" 
                            style="background:#2c3e50; width: auto; padding: 0 12px; justify-content: center; gap: 6px;" 
                            title="Salvar Cenário Atual">
                        <span class="material-icons" style="font-size:16px; color:#2ecc71;">save</span>
                        <span style="font-size: 11px;">Download Config</span>
                    </button>
                </div>

                <button class="header-btn btn-course" onclick="toggleCoursePanel()" style="background:#8e44ad; color:white;" title="Abrir Painel de Treinamento">
                    <span class="material-icons" style="font-size:16px">school</span> CURSO
                </button>
                
                <button class="header-btn btn-console" onclick="toggleConsole()" style="background:#34495e;">
                    <span class="material-icons" style="font-size:16px">terminal</span> CONSOLE
                </button>

                <div class="dropdown-export" style="position:relative; display:inline-block;">
                    <button class="header-btn btn-pdf" onclick="var m=document.getElementById('exportMenu'); m.style.display=(m.style.display==='block'?'none':'block');">
                        <span class="material-icons" style="font-size:16px">save_alt</span> RELATÓRIO
                    </button>
                    <div id="exportMenu" style="display:none; position:absolute; top:35px; right:0; background:#333; border:1px solid #555; border-radius:4px; z-index:1000; min-width:160px; box-shadow:0 5px 15px rgba(0,0,0,0.5);">
                        <div onclick="baixarPDFSimulacao(); document.getElementById('exportMenu').style.display='none'" style="padding:10px; color:#fff; cursor:pointer; border-bottom:1px solid #444; font-size:11px; display:flex; align-items:center; gap:8px;">
                            <span class="material-icons" style="font-size:14px; color:#aaa;">picture_as_pdf</span> PDF Visual
                        </div>
                        <div onclick="downloadTechnicalReport('txt'); document.getElementById('exportMenu').style.display='none'" style="padding:10px; color:#fff; cursor:pointer; border-bottom:1px solid #444; font-size:11px; display:flex; align-items:center; gap:8px;">
                            <span class="material-icons" style="font-size:14px; color:#aaa;">description</span> Relatório TXT
                        </div>
                        <div onclick="downloadTechnicalReport('json'); document.getElementById('exportMenu').style.display='none'" style="padding:10px; color:#fff; cursor:pointer; border-bottom:1px solid #444; font-size:11px; display:flex; align-items:center; gap:8px;">
                            <span class="material-icons" style="font-size:14px; color:#aaa;">data_object</span> Dados JSON
                        </div>
                        <div onclick="downloadTechnicalReport('csv'); document.getElementById('exportMenu').style.display='none'" style="padding:10px; color:#fff; cursor:pointer; font-size:11px; display:flex; align-items:center; gap:8px;">
                            <span class="material-icons" style="font-size:14px; color:#aaa;">table_view</span> CSV (Excel)
                        </div>
                    </div>
                </div>

                <button class="header-btn btn-clean" onclick="limparSimulacao(true)">
                    <span class="material-icons" style="font-size:16px">delete</span> LIMPAR
                </button>
            
                <button class="header-btn btn-deploy" onclick="runDeploySequence()">
                    <span class="material-icons" style="font-size:16px">rocket_launch</span> DEPLOY
                </button>
            </div>
            <button class="header-btn" onclick="toggleMindMap()" style="background:#2c3e50; margin-left: 10px; border: 1px solid #34495e;" title="Ver Arquitetura BBU">
              <span class="material-icons" style="color:#00ffff;">account_tree</span> ARQUITETURA
            </button>
        </div>
        
        <button id="btnNewSite" class="fab-add-site" onclick="openAddSiteModal()" title="Adicionar Novo Site">
            <span class="material-icons">add</span>
        </button>

        <div id="toast-container"></div>
        <svg id="cableLayer"></svg>

        <div class="source-box-base odu-compact-box draggable-box" id="oduLocal">
             <div class="sb-header" id="headerLocal">SITE LOCAL (BBU)</div>
             <div class="sb-body odu-compact-body">
                <span id="txtLocal" class="site-name-display">SPO001</span>
                <div style="display:flex; align-items:center;">
                    <button id="btnLocal" class="btn-compact-add" onclick="spawnODUCable('LOCAL', 'oduLocal')">+</button>
                    <span id="countLocal" class="compact-counter">0/6</span>
                </div>
             </div>
        </div>

        <div class="source-box-base odu-compact-box draggable-box" id="oduRemote">
             <div class="sb-header" id="headerRemote">SITE REMOTO</div>
             <div class="sb-body odu-compact-body">
                <span id="txtRemote" class="site-name-display">SPO002</span>
                <div style="display:flex; align-items:center;">
                    <button id="btnRemote" class="btn-compact-add" onclick="spawnODUCable('REMOTE', 'oduRemote')">+</button>
                    <span id="countRemote_oduRemote" class="compact-counter">0/6</span>
                </div>
             </div>
        </div>

        <div class="source-box-base tech-box trans-style" id="umptBox">
            <div class="tech-header">
                <span class="material-icons" style="font-size:14px;">router</span>
                <span>BACKHAUL / UMPT</span>
            </div>
            <div class="tech-body">
                <div class="tech-leds">
                    <div class="led green blink"></div> <span style="font-size:8px; color:#555">LINK</span>
                    <div class="led yellow"></div> <span style="font-size:8px; color:#555">ACT</span>
                </div>
                <div class="tech-port-area">
                    <button class="btn-tech-add" id="btnUmpt" onclick="spawnUMPTCable()">
                        <span class="material-icons">cable</span>
                    </button>
                    <span class="tech-counter" id="countUmpt">0/2</span>
                </div>
                <div class="tech-label-bottom">METRO ETHERNET</div>
            </div>
        </div>

        <div class="source-box-base tech-box gps-style" id="gpsBox">
            <div class="tech-header">
                <span class="material-icons" style="font-size:14px;">satellite_alt</span>
                <span>SYNC (GPS)</span>
            </div>
            <div class="tech-body">
                <div class="satellite-dish">
                    <span class="material-icons sat-icon">sensors</span>
                </div>
                <div class="tech-port-area">
                    <button class="btn-tech-add" id="btnGps" onclick="spawnGPSCable()">
                        <span class="material-icons">cable</span>
                    </button>
                    <span class="tech-counter" id="countGps">0/2</span>
                </div>
                <div class="tech-label-bottom">GPS ANTENNA</div>
            </div>
        </div>
        
        <div class="source-box-base" id="partsBox" style="width: 160px;"> 
             <div class="sb-header">PEÇAS</div>
            <div class="sb-body" style="display:flex; flex-direction:row; flex-wrap:wrap; justify-content:space-around; align-items:flex-start; gap:10px;">
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div class="btn-sfp-drag" onmousedown="spawnSFP(event)">SFP</div>
                    <span class="slot-counter" style="font-size:9px;">Arrastar</span>
                </div>
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div class="btn-sfp-drag" style="background:linear-gradient(to bottom, #95a5a6, #7f8c8d); border-color:#555; color:#fff;" onclick="spawnJumperCable()">JUMPER</div>
                    <span class="slot-counter" style="font-size:9px;">Cascata</span>
                </div>
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div class="btn-sfp-drag" style="background: linear-gradient(to bottom, #555, #333); color:#ccc; border:1px solid #777;" onmousedown="spawnDummy(event)" ondblclick="autoFillDummies()">TAMPA</div>
                    <span class="slot-counter" style="font-size:9px;">Duplo clique</span>
                </div>
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div class="btn-sfp-drag" style="background: linear-gradient(to bottom, #3498db, #2980b9); color:#fff; border:1px solid #1f618d;" onmousedown="spawnUSB(event)">USB</div>
                    <span class="slot-counter" style="font-size:9px;">Script</span>
                </div>
            </div>
        </div>
        
        <div class="source-box-base" id="dcduBox" style="display: none;">
            <div class="sb-header">DCDU-12B</div>
             <div class="sb-body">
                <button class="btn-mini-add" id="btnPwr" onclick="spawnDCDUCable()">+</button>
                <span class="slot-counter" id="countPwr">0/2</span>
                <div class="dcdu-switch-row"><span>SW-18</span><div id="sw18" class="dcdu-switch" onclick="toggleSwitch(18)"></div></div>
                <div class="dcdu-switch-row"><span>SW-19</span><div id="sw19" class="dcdu-switch" onclick="toggleSwitch(19)"></div></div>
            </div>
        </div>
        
        <div class="inventory-box" id="boardInventory">
            <div class="inv-header">Placas Disponíveis</div>
            <div class="inv-list" id="invList"></div>
        </div>

        <div class="bbu-chassis-grid" id="bbuGrid">
            <div class="bbu-slot fan-slot" style="grid-column: 1; grid-row: 1 / span 4;">FAN</div>
            
            <div id="bbuSlot0" class="bbu-slot bbu-slot-empty" data-slot="0" data-accept="UBBP" style="grid-column: 2; grid-row: 1;"><span class="slot-id-label">SLOT 0</span></div>
            <div id="bbuSlot1" class="bbu-slot bbu-slot-empty" data-slot="1" data-accept="UBBP" style="grid-column: 3; grid-row: 1;"><span class="slot-id-label">SLOT 1</span></div>
            
            <div id="bbuSlot18" class="bbu-slot bbu-slot-empty" data-slot="18" data-accept="UPEU" style="grid-column: 4; grid-row: 1 / span 2;">
                <span class="slot-id-label" style="color:#e74c3c">SLOT 18</span>
            </div>
            
            <div id="bbuSlot2" class="bbu-slot bbu-slot-empty" data-slot="2" data-accept="UBBP" style="grid-column: 2; grid-row: 2;"><span class="slot-id-label">SLOT 2</span></div>
            <div id="bbuSlot3" class="bbu-slot bbu-slot-empty" data-slot="3" data-accept="UBBP" style="grid-column: 3; grid-row: 2;"><span class="slot-id-label">SLOT 3</span></div>
            
            <div id="bbuSlot4" class="bbu-slot bbu-slot-empty" data-slot="4" data-accept="UBBP" style="grid-column: 2; grid-row: 3;"><span class="slot-id-label">SLOT 4</span></div>
            <div id="bbuSlot5" class="bbu-slot bbu-slot-empty" data-slot="5" data-accept="UBBP" style="grid-column: 3; grid-row: 3;"><span class="slot-id-label">SLOT 5</span></div>

            <div id="bbuSlot19" class="bbu-slot bbu-slot-empty" data-slot="19" data-accept="UPEU" style="grid-column: 4; grid-row: 3 / span 4;">
                <span class="slot-id-label" style="color:#e74c3c">SLOT 19</span>
            </div>
            
            <div id="bbuSlot6" class="bbu-slot bbu-slot-empty" data-slot="6" data-accept="UMPT" style="grid-column: 2; grid-row: 4;"><span class="slot-id-label" style="color:#f37021">SLOT 6</span></div>
            <div id="bbuSlot7" class="bbu-slot bbu-slot-empty" data-slot="7" data-accept="UMPT" style="grid-column: 3; grid-row: 4;"><span class="slot-id-label" style="color:#f37021">SLOT 7</span></div>
        </div>

        <div id="coursePanel" class="course-panel" style="display:none;">
          <div id="panelFinalReport" class="course-panel" style="display:none; bottom: 20px; right: 20px; left: auto; border-color: #2ecc71; z-index: 25000;">
            <div class="course-header" style="background: #2ecc71;">
                <span class="material-icons">emoji_events</span>
                <span>CERTIFICADO & MANUAL</span>
                <button class="btn-mini-close" onclick="document.getElementById('panelFinalReport').style.display='none'">✕</button>
            </div>
            
            <div class="course-body" style="align-items: center; text-align: center;">
                <h3 style="color: #2ecc71; margin: 0 0 10px 0;">PARABÉNS!</h3>
                <p style="color: #ccc; font-size: 11px; margin-bottom: 15px;">
                    Você completou todos os módulos do treinamento BBU5900.
                    <br>Realize a avaliação final para obter o manual e certificado.
                </p>
                
                <button class="btn-confirm" onclick="abrirModalCadastro()" style="width: 100%; background: #f1c40f; color: #000; display: flex; align-items: center; justify-content: center; gap: 5px;">
                    <span class="material-icons">quiz</span> REALIZAR AVALIAÇÃO FINAL
                </button>

                <button id="btnFinalDownloadManual" class="btn-confirm" onclick="downloadBonusManual(true)" style="width: 100%; background: #2ecc71; color: #fff; display: none; align-items: center; justify-content: center; gap: 5px; margin-top: 10px;">
                    <span class="material-icons">file_download</span> BAIXAR MANUAL & CERTIFICADO
                </button>
            </div>
        </div>
            <div class="course-header">
                <span class="material-icons">school</span>
                <span id="courseTitle">MÓDULO 0: INTRODUÇÃO</span>
                <button class="btn-mini-close" onclick="toggleCoursePanel()">✕</button>
            </div>
            <div class="course-body">
                <div id="courseDescription" class="course-desc">Bem-vindo ao Treinamento BBU Architect Simulator Selecione um módulo para começar.</div>
                
                <div class="course-objectives">
                    <strong>TAREFAS / OBJETIVOS:</strong>
                    <ul id="courseObjectivesList">
                        <li>Selecione um módulo abaixo para carregar o cenário.</li>
                    </ul>
                </div>

                <div id="courseFeedback" class="course-feedback">Aguardando início...</div>

                <div style="display:flex; flex-direction:column; gap:5px; margin-top:5px;">
                     <button id="btnStudyTheory" class="btn-course-action" style="background:#3498db; margin-bottom:5px;" onclick="openTheory()">
                        <span class="material-icons" style="font-size:12px; vertical-align:middle;">menu_book</span> ESTUDAR TEORIA
                     </button>
                     <button id="btnCheckModule" class="btn-course-action" onclick="checkModuleCompletion()">VALIDAR TAREFA</button>
                </div>

                <div class="course-controls">
                   <button id="btnPrevMod" class="btn-course-nav" onclick="prevModule()">&lt;</button>
                    <span id="lblModuleProgress">0 / 0</span>
                    <button id="btnNextMod" class="btn-course-nav" onclick="nextModule()">&gt;</button>
                </div>
            </div>
        </div>

        <div id="theoryModal" class="custom-modal-overlay" style="display:none; z-index: 26000;">
            <div class="theory-box" style="background:#1e1e24; width:600px; max-height:85vh; border:1px solid #3498db; border-radius:8px; display:flex; flex-direction:column; box-shadow:0 10px 40px rgba(0,0,0,0.9);">
                <div class="theory-header" style="background:#3498db; color:#fff; padding:12px; font-weight:bold; display:flex; align-items:center; justify-content:space-between;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span class="material-icons">menu_book</span>
                        <span id="theoryTitleText">CONCEITOS TEÓRICOS</span>
                    </div>
                    <button class="btn-mini-close" onclick="closeTheory()" style="color:#fff;">✕</button>
                </div>
                <div class="theory-body" id="theoryContent" style="padding:20px; overflow-y:auto; color:#ddd; font-size:14px; line-height:1.6; text-align:left;">
                    </div>
                <div class="theory-footer" style="padding:15px; border-top:1px solid #333; text-align:center; background:#181818;">
                    <button class="btn-confirm" onclick="finishTheory()" style="width:100%; background:#3498db; padding:12px;">LI E COMPREENDI</button>
                </div>
            </div>
        </div>

        <div id="polarityModal" class="custom-modal-overlay">
            <div class="custom-modal-box" style="width:400px; height:auto;">
                <h3 style="color:#f37021; margin-bottom:5px;">Polaridade DC</h3>
                <p style="color:#aaa; font-size:12px;">Conecte 0V (Positivo) e -48V (Negativo)</p>
                <div id="polarityGameContainer">
                    <div class="poly-column">
                        <div class="poly-point wire-blue" onmousedown="startPolyDrag(event, 'blue')"></div>
                        <div class="poly-point wire-black" onmousedown="startPolyDrag(event, 'black')"></div>
                    </div>
                    <div class="poly-column" style="margin-left:100px;">
                        <div id="termPos" class="poly-point term-pos"></div>
                        <div id="termNeg" class="poly-point term-neg"></div>
                    </div>
                    <svg id="polyLines" style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:5;"></svg>
                </div>
                <div class="modal-buttons">
                    <button class="btn-cancel" onclick="cancelPolarity()">Cancelar</button>
                    <button class="btn-confirm" onclick="confirmPolarity()">Confirmar Conexão</button>
                </div>
            </div>
        </div>
        
        <div id="rruModal" class="custom-modal-overlay">
          <div class="rru-modal-box">
            <div class="rru-header">
                <div style="display:flex; align-items:center; gap:10px;">
                    <span style="color:#f37021; font-weight:bold; font-size:12px;">CONFIGURAÇÃO RF</span>
                    <select id="rruCableSelector" class="rru-selector" onchange="onRRUSelectorChange()"></select>
                </div>
                <span style="cursor:pointer; font-weight:bold;" onclick="closeRRUModal()">✕</span>
            </div>
            <div id="rruModalBody"></div>
            <div class="rru-header" style="justify-content:flex-end; gap:10px;">
                <div id="rruStatus" style="margin-right:auto;font-size:11px;color:#777;">...</div>
                <button class="btn-cancel" onclick="closeRRUModal()">Fechar</button>
                <button class="btn-confirm" style="background:#e67e22;" onclick="validateVSWR()">Testar VSWR</button>
                <button class="btn-confirm" id="btnSaveRF" onclick="saveRFConfig()">Salvar</button>
            </div>
          </div>
        </div>

        <div id="cableConfigModal">
            <h4><span class="material-icons">settings</span> Configurar Cabo</h4>
            <div id="infoSourceType">TIPO: ...</div>
            
            <div id="configODUOptions">
                <div class="form-group">
                    <label>Setor (Define Cor)</label>
                    <select id="cfgSetor">
                        <option value="">Selecione...</option>
                        <option value="A">Setor A (Red)</option>
                        <option value="B">Setor B (Green)</option>
                        <option value="C">Setor C (Blue)</option>
                    </select>
                </div>
                <div style="border-top:1px solid #333; margin-top:10px; padding-top:10px;">
                    <label style="color:#2ecc71; font-size:10px; font-weight:bold;">RECURSOS DE RÁDIO (CARRIER)</label>
                    <div class="form-group" style="margin-top:5px;">
                        <label>Portadoras LTE (20MHz)</label>
                        <select id="cfgLteCount">
                            <option value="0">Nenhum</option>
                            <option value="1">1x 20MHz</option>
                            <option value="2">2x 20MHz</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Portadora NR (5G)</label>
                        <select id="cfgNrBw">
                            <option value="0">Nenhum</option>
                            <option value="30">1x 30MHz</option>
                            <option value="40">1x 40MHz</option>
                            <option value="50">1x 50MHz</option>
                            <option value="80">1x 80MHz</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Modelo Rádio</label>
                    <select id="cfgRadio">
                        <option value="64TR Huawei">64TR Huawei (AAU)</option>
                        <option value="8TR Huawei">8TR Huawei (RRU)</option>
                        <option value="4TR Huawei">4TR Huawei (RRU)</option>
                    </select>
                </div>
            </div>
        
            <div class="modal-buttons-row">
                <button class="btn-confirm" id="btnSalvarCabo" onclick="aplicarConfigCabo()">
                    <span class="material-icons" style="font-size:14px;">check</span> SALVAR
                </button>
                <button class="btn-cancel btn-icon-only" id="btnDeletarCabo" onclick="deletarCaboAtivo()" title="Excluir Cabo">
                     <span class="material-icons">delete</span>
                </button>
            </div>
        </div>

    </div>

    <div id="consoleModal" class="custom-modal-overlay" style="display:none; align-items:center; justify-content:center; backdrop-filter:blur(5px);">
        <div class="console-box">
            <div class="console-header">
                <div class="header-info">
                    <span class="material-icons header-icon">terminal</span>
                    <span class="header-title">MAINTENANCE TERMINAL</span>
                    <span class="header-meta" id="lblConsoleSite">[SPO001] • SSH: 22</span>
                </div>
                <button class="btn-close-console" onclick="toggleConsole()" title="Fechar Console (ESC)">
                    <span class="material-icons">close</span>
                </button>
            </div>
            
            <div class="console-layout">
                <div class="console-sidebar">
                    <div class="sidebar-section-title">COMMAND PALETTE</div>
                    <div class="cmd-item" onclick="quickCmd('DSP BRD')">
                        <div class="cmd-icon"><span class="material-icons">developer_board</span></div>
                        <div class="cmd-info"><span class="cmd-name">DSP BRD</span><span class="cmd-desc">Inventory Check</span></div>
                    </div>
                    <div class="cmd-item" onclick="quickCmd('LST ALM')">
                        <div class="cmd-icon warning"><span class="material-icons">warning_amber</span></div>
                        <div class="cmd-info"><span class="cmd-name">LST ALM</span><span class="cmd-desc">Active Alarms</span></div>
                    </div>
                    <div class="cmd-item" onclick="quickCmd('DSP VSWR')">
                        <div class="cmd-icon"><span class="material-icons">signal_cellular_alt</span></div>
                        <div class="cmd-info"><span class="cmd-name">DSP VSWR</span><span class="cmd-desc">RF/Antenna Test</span></div>
                    </div>
                    <div class="cmd-item" onclick="quickCmd('SET DEVIP')">
                        <div class="cmd-icon" style="color:#3498db;">
                            <span class="material-icons">settings_ethernet</span>
                        </div>
                        <div class="cmd-info">
                            <span class="cmd-name">SET DEVIP</span>
                            <span class="cmd-desc">Auto-Config IP</span>
                        </div>
                    </div>
                    <div class="cmd-item" onclick="quickCmd('CLS')">
                        <div class="cmd-icon"><span class="material-icons">backspace</span></div>
                        <div class="cmd-info"><span class="cmd-name">CLS</span><span class="cmd-desc">Clear Buffer</span></div>
                    </div>
                    <div class="sidebar-footer">
                        <div class="status-dot online"></div>
                        <div class="status-text">
                            <div>LINK: ESTABLISHED</div>
                            <div style="opacity:0.5; font-size:8px;">LATENCY: 4ms (AQZ_PROVA)</div>
                        </div>
                    </div>
                </div>

                <div class="console-main-area">
                    <div class="console-body" id="consoleOutput">
                        <div class="console-line header-msg">Huawei MML Command Interface</div>
                        <div class="console-line">Version: V100R019C10SPC100 (LTS)</div>
                        <div class="console-line">Copyright (c) Huawei Technologies Co., Ltd.</div>
                        <br>
                        <div class="console-line success-msg">System initialized. Connection secure.</div>
                        <br>
                    </div>
                    <div class="console-input-area">
                        <span class="prompt-char">&gt;</span>
                        <input type="text" id="cmdInput" class="cmd-input" placeholder="Enter MML command..." autocomplete="off">
                        <div class="input-badge">MML</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="usbInstallModal" style="display:none;">
        <div class="usb-modal-header">
            <span class="material-icons" style="font-size:16px; color:#2ecc71;">save_alt</span>
            <span>INSTALANDO ARQUIVOS...</span>
        </div>
        <div class="usb-progress-track">
            <div id="usbProgressBar" class="usb-progress-fill"></div>
        </div>
        <div class="usb-status-text">Não desconecte o dispositivo.</div>
    </div>

    <div id="pdfInfoModal" class="custom-modal-overlay" style="display:none; z-index: 60000;">
        <div class="custom-modal-box" style="border-color: #9b59b6;">
            <h3 style="color:#9b59b6; margin-bottom:15px;">DADOS DO PROJETO</h3>
            
            <div class="form-group" style="text-align:left; width:100%;">
                <label style="color:#aaa;">Nome do Projetista:</label>
                <input type="text" id="inDesignerName" class="input-remote-site" placeholder="Ex: João da Silva" style="width:100%;">
            </div>
            
            <div class="form-group" style="text-align:left; width:100%; margin-top:10px;">
                <label style="color:#aaa;">Cidade / UF:</label>
                <input type="text" id="inCityState" class="input-remote-site" placeholder="Ex: Juazeiro do Norte - CE" style="width:100%;">
            </div>

            <div class="modal-buttons" style="margin-top:20px;">
                <button class="btn-cancel" onclick="document.getElementById('pdfInfoModal').style.display='none'">CANCELAR</button>
                <button class="btn-confirm" style="background:#9b59b6; color:#fff;" onclick="gerarPDFFinal()">GERAR PDF</button>
            </div>
        </div>
    </div>

    <div id="quizRegModal" class="custom-modal-overlay" style="display:none; z-index: 60000;">
        <div class="custom-modal-box" style="border-color: #3498db;">
            <h3 style="color:#3498db; margin-bottom:15px;">DADOS DO ALUNO</h3>
            <p style="color:#aaa; font-size:12px; margin-bottom:15px;">Identifique-se para iniciar a avaliação.</p>
            
            <div class="form-group" style="text-align:left; width:100%;">
                <label>Nome Completo:</label>
                <input type="text" id="inQuizName" class="input-remote-site" placeholder="Seu nome..." style="width:100%;">
            </div>
            
            <div class="form-group" style="text-align:left; width:100%; margin-top:10px;">
                <label>Cargo / Função:</label>
                <input type="text" id="inQuizRole" class="input-remote-site" placeholder="Ex: Técnico de Campo" style="width:100%;">
            </div>

            <div class="modal-buttons" style="margin-top:20px;">
                <button class="btn-cancel" onclick="document.getElementById('quizRegModal').style.display='none'">CANCELAR</button>
                <button class="btn-confirm" style="background:#3498db; color:#fff;" onclick="iniciarProva()">INICIAR PROVA</button>
            </div>
        </div>
    </div>

    <div id="quizMainModal" class="custom-modal-overlay" style="display:none; z-index: 61000; align-items:start; padding-top: 50px; overflow-y: auto;">
        <div class="setup-box" style="width: 700px; max-height: 90vh; overflow-y: auto; border-color: #8e44ad; background: #1e1e24;">
            
            <div style="display: flex; justify-content: space-between; align-items: flex-start; width: 100%; margin-bottom: 20px;">
                <div>
                    <h2 style="font-size: 18px; margin: 0;">AVALIAÇÃO FINAL</h2>
                    <span id="lblStudentName" style="font-size:12px; color:#aaa; display:block; margin-top:5px;"></span>
                </div>
                <button class="btn-cancel" onclick="sairDaAvaliacao()" style="padding: 6px 12px; font-size: 11px; border-color: #e74c3c; color: #e74c3c;">
                    <span class="material-icons" style="font-size: 12px; vertical-align: middle; margin-right: 4px;">logout</span> SAIR
                </button>
            </div>
            <div id="quizContainer" style="text-align: left; width: 100%;">
            </div>
            
            <div id="quizFooter" style="margin-top: 30px; text-align: center; border-top: 1px solid #333; padding-top: 20px;">
                <button class="btn-confirm" onclick="calcularResultadoQuiz()" style="font-size: 16px; padding: 12px 30px;">VER RESULTADO</button>
            </div>

            <div id="quizResultArea" style="display:none; margin-top: 20px; text-align: center; background: #111; padding: 20px; border-radius: 8px;">
                <div id="scoreCircle" style="font-size: 40px; font-weight: bold; margin-bottom: 10px;">0%</div>
                <div id="scoreText" style="color: #ccc; margin-bottom: 15px;"></div>
                <div id="quizActions">
                    </div>
            </div>
        </div>
    </div>
    
    <div id="certificateTemplate" style="position:fixed; top:-9999px; left:-9999px; width:1123px; height:794px; background:#fff; z-index:-1; font-family: 'Times New Roman', serif; color:#000;">
        <div style="width:100%; height:100%; padding:30px; box-sizing:border-box; background:#fff;">
            <div style="width:100%; height:100%; border:3px double #1e8449; padding:5px; box-sizing:border-box; position:relative;">
                <div style="width:100%; height:100%; border:1px solid #d4af37; padding:50px; box-sizing:border-box; display:flex; flex-direction:column; align-items:center; justify-content:space-between; background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(245,250,245,0.3) 100%);">
                    
                    <div style="text-align:center; width:100%;">
                        <h1 style="margin:0; font-size:36px; color:#1e8449; letter-spacing:8px; font-family:'Segoe UI', sans-serif; text-transform:uppercase; font-weight:300;">BBU Architect Simulator</h1>
                        <div style="width:100px; height:1px; background:#d4af37; margin:15px auto;"></div>
                        <h2 style="margin:10px 0 0 0; font-size:32px; color:#2c3e50; letter-spacing:3px; text-transform:uppercase; font-weight:bold;">Certificado de Conclusão</h2>
                    </div>

                    <div style="text-align:center; width:100%; flex:1; display:flex; flex-direction:column; justify-content:center;">
                        <p style="font-size:16px; color:#666; margin:0; text-transform:uppercase; letter-spacing:1px;">Certificamos que o aluno(a)</p>
                        
                        <h1 id="certStudentName" style="font-size:42px; margin:25px 0; color:#000; border-bottom:1px solid #ccc; display:inline-block; padding:0 40px 5px 40px; font-style:italic; font-family: 'Times New Roman', serif;">
                            NOME DO ALUNO
                        </h1>
                        
                        <p style="font-size:16px; color:#555; margin:5px 0;">
                            Atuando na função de: <strong id="certStudentRole" style="color:#1e8449; font-weight:bold;">CARGO</strong>
                        </p>

                        <div style="margin:35px 0;">
                            <p style="font-size:18px; color:#333; margin:0;">Concluiu com êxito o Treinamento Técnico Prático de</p>
                            <h2 style="font-size:26px; color:#1e8449; margin:15px 0; text-transform:uppercase; letter-spacing:1px;">Arquitetura, Instalação e Deploy de BBU 5900</h2>
                            <p style="font-size:14px; color:#777; max-width:800px; margin:0 auto; line-height:1.5;">Demonstrando proficiência prática em: Identificação de Hardware, Sistema de Energia (-48V), Cabeamento Óptico (SFP/Fibras), Instalação de Torre (RRU) e Comandos MML.</p>
                        </div>
                    </div>

                    <div style="width:100%; display:flex; justify-content:space-between; align-items:flex-end; margin-top:10px;">
                        <div style="text-align:left;">
                            <p style="font-size:12px; color:#999; text-transform:uppercase; margin-bottom:5px;">Data de Emissão</p>
                            <p id="certDate" style="font-size:16px; font-weight:bold; margin:0; color:#333;">00/00/0000</p>
                            <p id="certHash" style="font-size:10px; color:#aaa; margin-top:8px; font-family:'Courier New', monospace;">ID: 5900-xxx-000</p>
                        </div>

                        <div style="text-align:center; width:350px;">
                            <div style="font-family:'Brush Script MT', cursive; font-size:25px; color:#000; margin-bottom:5px; white-space:nowrap;">
                                Thalianderson P. S. Araújo
                            </div>
                            <div style="width:100%; height:1px; background:#333; margin-bottom:8px;"></div>
                            <p style="font-size:12px; font-weight:bold; margin:0; text-transform:uppercase; letter-spacing:1px;">Thalianderson Patricio Souza Araújo</p>
                            <p style="font-size:11px; color:#666; margin:2px 0 0 0;">Instrutor Técnico / Autor BBU Architect Simulator</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    
    <div id="saveScenarioModal" class="custom-modal-overlay" style="display:none; z-index: 60000;">
        <div class="custom-modal-box" style="border-color: #2ecc71; width: 400px;"> <h3 style="color:#2ecc71; margin-bottom:15px;">SALVAR CONFIGURAÇÃO</h3>
            
            <div class="form-group" style="text-align:left; width:90%;">
                <label style="color:#aaa;">Nome do Arquivo:</label>
                <input type="text" id="inScenarioName" class="input-remote-site" placeholder="Ex: Site_SPO001_V1" style="width:100%;">
            </div>

            <div class="form-group" style="text-align:left; width:100%; margin-top: 15px;">
                <label style="color:#aaa;">Notas de Engenharia / Comentários:</label>
                <textarea id="inScenarioNotes" class="input-remote-site" rows="4" 
                    placeholder="Descreva o que foi feito ou deixe avisos para a próxima expansão..." 
                    style="width:90%; resize: vertical; font-family: 'Segoe UI', sans-serif;"></textarea>
            </div>

            <div class="modal-buttons" style="margin-top:20px;">
                <button class="btn-cancel" onclick="document.getElementById('saveScenarioModal').style.display='none'">CANCELAR</button>
                <button class="btn-confirm" onclick="confirmarDownloadCenario()">BAIXAR .JSON</button>
            </div>
        </div>
    </div>

    <div id="projectNotesModal" class="custom-modal-overlay" style="display:none; z-index: 61000;">
        <div class="custom-modal-box" style="border-color: #3498db; width: 450px; text-align: left;">
            <h3 style="color:#3498db; margin-bottom:10px; text-align: center;">RESUMO DO PROJETO</h3>
            
            <div style="background: #111; padding: 15px; border-radius: 4px; border: 1px solid #333; color: #ccc; font-size: 13px; line-height: 1.5;">
                <p><strong style="color:#fff;">Data do Backup:</strong> <span id="lblLoadDate">...</span></p>
                <p><strong style="color:#fff;">Nome do Site:</strong> <span id="lblLoadSite">...</span></p>
                <hr style="border: 0; border-top: 1px solid #444; margin: 10px 0;">
                <p><strong style="color:#3498db;">NOTAS DE ENGENHARIA:</strong></p>
                <p id="lblLoadNotes" style="white-space: pre-wrap; font-style: italic; color: #aaa;">...</p>
            </div>

            <div class="modal-buttons" style="margin-top:20px; justify-content: center;">
                <button class="btn-confirm" style="background: #3498db;" onclick="document.getElementById('projectNotesModal').style.display='none'">ENTENDIDO</button>
            </div>
        </div>
    </div>
    
    <div id="mindMapModal" class="custom-modal-overlay" style="display:none; z-index: 55000; align-items: center; justify-content: center;">
        <div class="theory-box" style="background:#0a0a0a; width:95%; height:90%; border:1px solid #00ffff; display:flex; flex-direction:column; box-shadow:0 0 50px rgba(0,255,255,0.15);">
            
            <div class="theory-header" style="background:linear-gradient(90deg, #001f1f, #000); padding:15px; border-bottom:1px solid #00ffff; display:flex; justify-content:space-between; align-items:center;">
                <div style="display:flex; align-items:center; gap:10px;">
                    <span class="material-icons" style="color:#00ffff; font-size: 24px;">hub</span>
                    <div>
                        <span style="color:#fff; font-weight:bold; font-size:16px; display:block; letter-spacing:1px;">ARQUITETURA DE SISTEMA BBU 5900</span>
                        <span style="color:#00ffff; font-size:10px; opacity:0.7;">DIAGRAMA TÉCNICO INTERATIVO</span>
                    </div>
                </div>
                <button class="btn-mini-close" onclick="toggleMindMap()" style="color:#fff; font-size:24px; cursor:pointer;">✕</button>
            </div>

            <div id="mindMapContainer" style="flex:1; overflow:auto; padding:40px; background:#050505; position:relative;">
            </div>
        </div>
    </div>

    <script src="script.js?v=2"></script>
<script src="data.js?v=2"></script>
<script src="style.css?v=2"></script>
  </body>
</html>